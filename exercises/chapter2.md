# 第2章 演習問題の解答

### 演習問題2.1
ワンホット表現における各要素を等しく取り扱う場合には距離が等しくなるので、等しくない取り扱いをすればよい。
例えば、以下のように要素の順番において異なる重み $`w_k > 0`$ を用いて距離を計算すれば、一般に 2 つのワンホット表現（次元 $`n`$）$`d_i, d_j`$ の距離は異なるものとなる。

$$
\mathrm{dist} (d_i, d_j) = \sqrt{\sum_{k = 1}^n w_k d_{i, k} d_{j, k} }
$$

これは定義より明らかに距離の公理（非退化、対称、三角不等式）も満たす。
また、これはマハラノビス距離の対角成分のみを有するものに等しい。
どの位置の要素であるかを区別しているのでそのような状況のみで使い得る距離であるが、このようにワンホット表現でも 2 つのトークン間の距離が異なるものを構築することは可能である。

---

### 演習問題2.2
例として `A「遅くなってごめん」B「やっとね」` という文章を考えよう。
B の「やっとね」は同じ文脈に対して使われているが、待ち侘びていてついに会えたという好意的な意味と解釈することもできるし、長らく待たされていて相手を非難する意味と解釈することもできる。

分布仮説は「単語の意味はその単語が登場する文脈によって形成される」というものであったが、文脈をどこまでと捉えるかについては微妙な点を含んでいる。
この文章の前にも文脈があって、AとBが恋人同士で久しぶりに会うことなどが記述されていれば好意的な意味と解釈できるし、代わりに長く待たされていることへの苛立ちなどが記述されていれば非難の意味と解釈するのが自然になる。
一方で、明確な記述がなくて読み手が好きに解釈できるようになっているかもしれない。
また、大量のデータで学習したテキスト生成モデルであれば、この例の文章だけでも好意的な意味も非難の意味もあり得ることを知っており、学習したデータ分布に基づいてどちらがより尤もらしいかを出力することも可能である。

分布仮説は唯一の数学的定義があるものではなく、具体的に何を指すかは場合によるため、分布仮説の議論をする際にはまずは認識を揃えるとよいだろう。

---

### 演習問題2.3
$`\mathcal{S}_{\texttt{gem}} = \{\texttt{priceless}, \texttt{priceless}, \texttt{jewelry}, \texttt{jewelry}, \texttt{ray}\}, \mathcal{S}_{\texttt{jewel}} = \{\texttt{priceless}, \texttt{priceless}, \texttt{priceless}, \texttt{jewelry}, \texttt{ray}, \texttt{faceting}\}`$ であある。

重複排除をする場合（type 条件）は、$` \mathcal{count} (\texttt{gem}_y) = 3, \mathcal{count} (\texttt{jewel}_y) = 4 `$ で $` \texttt{gem}_y \cap \texttt{jewel}_y = \{\texttt{priceless}, \texttt{jewelry}, \texttt{ray} \} `$ であるので、$`M_y = \frac{3}{3} = 1`$ である。

重複排除をしない場合（token 条件）は、$` \mathcal{count} (\texttt{gem}_k) = 5, \mathcal{count} (\texttt{jewel}_k) = 6 `$ で $` \texttt{gem}_y \cap \texttt{jewel}_y = \{\texttt{priceless}, \texttt{priceless}, \texttt{jewelry}, \texttt{ray} \} `$ であるので、$`M_k = \frac{4}{5} = 0.8`$ である。

---
